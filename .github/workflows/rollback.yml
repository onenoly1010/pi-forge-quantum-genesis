name: "Rollback Testnet (Manual + Confirmed)"
on:
  workflow_dispatch:
    inputs:
      confirm:
        description: 'Type ROLLBACK to execute'
        required: true
jobs:
  rollback:
    if: inputs.confirm == 'ROLLBACK'
    runs-on: ubuntu-latest
    steps:
      - name: Rollback via Railway
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
        run: |
          npm i -g @railway/cli
          railway login --token "$RAILWAY_TOKEN"
          railway link ${{ secrets.RAILWAY_PROJECT_ID }}
          echo "Rolling back all services..."
          railway up --rollback
          echo "Rollback complete"
